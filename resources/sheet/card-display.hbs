{{#*inline "cardDisplay"}}
    <div class="flexcol card-slot {{card.classes}}" 
         style="background-image: url('{{card.cardBg}}');" 
         data-key="{{card.id}}">
        {{#unless card.displayed }}
            <p class="summary">{{card.summary}}</p>
        {{/unless}}
    </div>
{{/inline}}

{{#*inline "selectCardsParameters"}}
    <div class="parameters-cards">
        <div class="flexrow cards">
            {{#each param.availableCards as |card|}}
                {{> cardDisplay card=card}}
            {{/each}}
        </div>

        {{#if param.isReady}}
            <div class="flexrow bellow-cards">
                <div class="action-button selection-ok">
                    {{param.buttonLabel}}
                </div>
            </div>
        {{/if}}
    </div>
{{/inline}}

{{#*inline "selectStacksParameters"}}
    <div class="flexcol parameters-stacks">
        {{#if param.handsDisplayed}}
            <div class="headers">{{param.labels.headerHands}}</div>
            <div class="flexrow frame stacks">
                {{#each param.hands as |stack|}}
                    <div class="stack {{stack.classes}}"
                        style="background-image: url('{{stack.icon}}');"
                        data-key="{{stack.id}}">
                        {{stack.name}}
                    </div>
                {{/each}}
            </div>
        {{/if}}

        {{#if param.revealedCardsDisplayed}}
            <div class="headers">{{param.labels.headerRevealed}}</div>
            <div class="flexrow frame stacks">
                {{#each param.revealedCards as |stack|}}
                    <div class="stack {{stack.classes}}"
                        style="background-image: url('{{stack.icon}}');"
                        data-key="{{stack.id}}">
                        {{stack.name}}
                    </div>
                {{/each}}
            </div>
        {{/if}}

        {{#if param.specifyAmount}}
            <div class="headers">{{param.labels.headerAmount}}</div>
            <div class="flexrow frame amount-panel">
                <a class="amount-edit" data-action="minus" ><i class="far fa-minus-square"></i></a>
                <span class="amount-value">{{param.amount}}</span>
                <a class="amount-edit" data-action="plus"><i class="far fa-plus-square"></i></a>
            </div>
        {{/if}}

        {{#if param.isReady}}
            <div class="action-button selection-ok">
                {{param.labels.button}}
            </div>
        {{/if}}
    </div>
{{/inline}}

{{#*inline "actionListing"}}
    <div class="flexcol action-panel">
        {{#if onSide.actions.length}}
            <div class="headers">{{onSide.header}}</div>
        {{/if}}
        {{#each onSide.actions as |action|}}
            <div class="card-action {{action.classes}}" data-action="{{action.action}}">
                {{action.label}}
            </div>
        {{/each}}
    </div>
{{/inline}}

<form class="{{cssClass}}" autocomplete="off">

    <div class="flexrow current-selection">

        {{#if parameters.none}}
            {{> actionListing onSide=onLeft}}
        {{/if}}

        <div class="flexrow main-card-slot" >
            {{> cardDisplay card=currentSelection}}
        </div>

        {{#if parameters.none}}
            {{> actionListing onSide=onRight}}
        {{else}}
            <div class="flexcol parameters-panel">
                <div class="flexrow headers">
                    <div class="title">{{parameters.title}}</div>
                    <i class="fas fa-times cancel"></i>
                </div>

                {{#if parameters.needCards}}
                    {{> selectCardsParameters param=parameters}}
                {{/if}}

                {{#if parameters.needStacks}}
                    {{> selectStacksParameters param=parameters}}
                {{/if}}

            </div>
        {{/if}}
    </div>


    {{#if listing.allowed }}
        <div class="flexrow listing-panel">
            
            <div class="listing-toggle">
                {{#if listing.opened}}
                    <i class="fas fa-eye-slash"></i>
                {{else}}
                    <i class="fas fa-list"></i>
                {{/if}}
            </div>

            {{#if listing.opened}}
                <div class="flexrow all-cards">
                    {{#each listing.cards as |card|}}
                        {{> cardDisplay card=card}}
                    {{/each}}
                </div>
            {{/if}}
        </div>
    {{/if}}

</form>
