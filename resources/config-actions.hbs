{{#* inline "listConfigs" }}

    {{#each actions as |action| }}
        {{#if action.isHeader }}
            {{> configHeader header=action }}
        {{else}}
            {{> actionLine action=action }}
        {{/if}}
    {{/each}}

    {{#each boxes as |box| }}
        {{#if box.isHeader }}
            {{> configHeader header=box }}
        {{else}}
            {{> configLine box=box }}
        {{/if}}
    {{/each}}
{{/inline}}

{{#*inline "configHeader"}}
    <div class="flexrow deck-row content header">
        <div>{{header.label}}</div>
    </div>
{{/inline}}

{{#*inline "configLine"}}
    <div class="flexrow deck-row content conf">
        <i class="toggle-button config {{box.classes}}" data-config="{{box.config}}"></i>
        <div>{{box.label}}</div>
    </div>
{{/inline}}

{{#*inline "actionLine"}}
    <div class="flexrow deck-row content action" data-param="{{action.param}}">
        <i class="toggle-button action {{action.classes}}"></i>
        <div>{{action.label}}</div>
        {{#if action.input.displayed}}
            <input type="text" class="param-input" value="{{action.input.text}}" >
        {{/if}}
    </div>
{{/inline}}


<form>
    <p class="notification info">{{localize 'RTUCards.settings.config-actions.title'}}</p>

    <div class="flexcol deck-list">

        <!-- Filter -->
        <div class="flexcol filter">
            <div class="flexrow deck-row">
                <i class="fas fa-filter toggle-button"></i>
                {{#if filter.detailsDisplayed}}
                    <i class="fas fa-sort-down toggle-button active show"></i>
                {{else}}
                    <i class="fas fa-sort-up toggle-button active show"></i>
                {{/if}}
                <div>{{filter.title}}</div>
            </div>
            {{#if filter.detailsDisplayed}}
                {{> listConfigs boxes=filter.configBoxes actions=filter.actions }}
            {{/if}}
        </div>

        {{#each stacks as |stack| }}
            <div class="flexcol declared-deck" data-key={{stack.key}}>
                <div class="flexrow deck-row">
                    {{#if stack.gui.toggled}}
                        <i class="far fa-check-square toggle-button {{#unless stack.gui.toggleLocked}}active deck{{/unless}}"></i>
                        {{#if stack.gui.detailsDisplayed}}
                            <i class="fas fa-sort-down toggle-button active show"></i>
                        {{else}}
                            <i class="fas fa-sort-up toggle-button active show"></i>
                        {{/if}}
                    {{else}}
                        <i class="far fa-square toggle-button active deck"></i>
                    {{/if}}
                    <div>{{stack.gui.deck.name}}</div>
                </div>
                {{#if stack.gui.detailsDisplayed}}
                    {{> listConfigs boxes=stack.configBoxes actions=stack.actions }}
                {{/if}}
            </div>
        {{/each}}
    </div>
    <button class="save-stacks">{{localize "RTUCards.settings.config-actions.saveAndClose"}}</button>
</form>